--가장 비싼 상품 구하기
SELECT MAX(PRICE) AS MAX_PRICE
FROM PRODUCT

--가격이 제일 비싼 식품의 정보 출력하기
SELECT *
FROM FOOD_PRODUCT
WHERE PRICE = (SELECT MAX(PRICE) FROM FOOD_PRODUCT)

SELECT *
FROM FOOD_PRODUCT
ORDER BY PRICE DESC
LIMIT 1

--최대값 구하기
SELECT MAX(datetime) 
FROM animal_ins

--최소값 구하기
SELECT MIN(datetime) 
FROM animal_ins

--동물 수 구하기
SELECT COUNT(animal_id) 
FROM animal_ins

--중복 제거하기
SELECT  COUNT(DISTINCT name) 
FROM animal_ins

--조건에 맞는 가격의 총합 구하기
SELECT SUM(PRICE) AS TOTAL_PRICE
FROM ITEM_INFO
WHERE RARITY = 'LEGEND'

--잡은 물구고기 중 가장 큰 물고기의 길이 구하기
SELECT CONCAT(MAX(LENGTH),'cm') AS MAX_LENGTH
FROM FISH_INFO 

--연도별 대장균 크기의 편차 구하기
WITH MAX_SIZE AS(
    SELECT YEAR(DIFFERENTIATION_DATE) AS YEAR , MAX(SIZE_OF_COLONY) AS MAX_SIZE
    FROM ECOLI_DATA
    GROUP BY YEAR(DIFFERENTIATION_DATE)
)

SELECT M.YEAR , M.MAX_SIZE - D.SIZE_OF_COLONY AS YEAR_DEV,D.ID
FROM ECOLI_DATA D JOIN MAX_SIZE M
ON YEAR(D.DIFFERENTIATION_DATE) = M.YEAR
ORDER BY 1,2

--물고기 종류 별 대어 찾기
WITH RANKING AS(
    SELECT 
    *, 
    RANK() OVER(PARTITION BY FISH_TYPE ORDER BY LENGTH DESC) AS RANKING
    FROM FISH_INFO  
)

SELECT 
ID,	
FISH_NAME,
LENGTH
FROM RANKING R JOIN FISH_NAME_INFO FNI
USING(FISH_TYPE)
WHERE RANKING = 1
ORDER BY 1